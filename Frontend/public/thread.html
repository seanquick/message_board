<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thread</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* minimal extras for the thread page */
    .container { max-width: 960px; margin: 0 auto; padding: 1rem; }
    .card { background:#fff; border:1px solid #eee; border-radius:10px; padding:1rem; }
    .row { display:flex; gap:.5rem; align-items:center; }
    .meta { color:#6b7280; font-size:.9rem; }
    .pill { padding:.15rem .45rem; border-radius:999px; font-size:.8rem; background:#eef; color:#334; display:inline-block; }
    .ok { color:#15803d; } .danger { color:#b91c1c; }
    .btn { padding:.35rem .6rem; border:1px solid #ddd; background:#f9fafb; border-radius:6px; cursor:pointer; }
    .btn.tiny { padding:.2rem .45rem; font-size:.85rem; }
    .btn.primary { background:#111827; color:#fff; border-color:#111827; }
    .btn[disabled], button[disabled], textarea[disabled] { opacity:.6; cursor:not-allowed; }
    .comment { border-top:1px solid #eee; padding-top:.75rem; margin-top:.75rem; }
    .comment .body { white-space:pre-wrap; }
    .children { margin-left:1rem; border-left:2px solid #f3f4f6; padding-left:.75rem; }
    .truncate { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .highlight { animation:hl 2s ease-out; background: #fff7cc; }
    @keyframes hl { 0%{ background:#fff7cc; } 100%{ background:transparent; } }
    .composer { margin-top:1rem; }
    textarea { width:100%; min-height:100px; padding:.6rem; border:1px solid #e5e7eb; border-radius:8px; }
    label.inline { display:flex; align-items:center; gap:.35rem; }
  </style>
</head>
<body>
  <main class="container">
    <div id="topErr" class="err" aria-live="polite" style="display:none"></div>

    <!-- Thread -->
    <section id="threadSection" class="card">
      <div id="threadHeader" class="row" style="justify-content:space-between">
        <div>
          <h1 id="threadTitle" style="margin:.1rem 0 .4rem 0; font-size:1.5rem">Loading‚Ä¶</h1>
          <div class="meta" id="threadMeta">‚Äî</div>
        </div>
        <div class="row">
          <span id="badgePinned" class="pill" style="display:none">Pinned</span>
          <span id "badgeLocked" class="pill" style="display:none">Locked</span>
        </div>
      </div>

      <!-- Report button -->
      <div style="margin-top:.5rem;">
        <button id="reportThreadBtn" class="btn tiny" data-thread-id="">Report Thread</button>
      </div>

      <!-- üîí Lock banner (hidden by default) -->
      <div id="lockedBanner" style="display:none;margin:.75rem 0;padding:.6rem .8rem;border:1px solid #f3d9d9;background:#fff5f5;color:#7c1f1f;border-radius:8px">
        üîí This thread is locked. New comments are disabled.
      </div>

      <article id="threadBody" class="mono" style="white-space:pre-wrap; margin-top:.75rem">‚Äî</article>

      <div class="row" style="margin-top:.75rem; gap:.5rem">
        <button id="threadUpvote" class="btn tiny">‚¨ÜÔ∏è Upvote (<span id="threadUpvoteCount">0</span>)</button>
        <a id="backToThreads" class="btn tiny" href="threads.html">‚Üê Back</a>
      </div>
    </section>

    <!-- Comments -->
    <section id="commentsSection" class="card" style="margin-top:1rem">
      <h2 style="margin-top:0">Comments</h2>
      <div id="commentsList">Loading‚Ä¶</div>

      <!-- Composer -->
      <div class="composer">
        <form id="replyForm">
          <div id="replyingTo" class="meta" style="display:none; margin-bottom:.35rem"></div>
          <textarea name="body" id="replyBody" placeholder="Write a comment‚Ä¶"></textarea>
          <input type="hidden" name="parentId" id="parentId" />

          <!-- üîí Honeypot anti-bot field (leave empty) -->
          <div aria-hidden="true"
               style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden">
            <label for="hpWebsite">Website</label>
            <input type="text" name="website" id="hpWebsite" tabindex="-1" autocomplete="off" />
          </div>

          <div class="row" style="margin-top:.5rem; justify-content:space-between">
            <label class="inline">
              <input type="checkbox" id="isAnonymous" name="isAnonymous" />
              <span>Post as Anonymous</span>
            </label>
            <div class="row" style="gap:.5rem">
              <button type="button" id="cancelReply" class="btn tiny" style="display:none">Cancel reply</button>
              <button type="submit" class="btn tiny primary">Post comment</button>
            </div>
          </div>
        </form>
        <div id="loginHint" class="meta" style="display:none; margin-top:.5rem">Please log in to comment.</div>
      </div>
    </section>
  </main>

  <!-- shared utilities -->
  <script type="module" src="nav.js"></script>
  <script type="module" src="main.js"></script>
  <!-- reporting logic -->
  <script type="module" src="report.js"></script>
  <script type="module">
    import { initReportUI } from './report.js';
    document.addEventListener('DOMContentLoaded', initReportUI);
  </script>
  <!-- page script -->
  <script type="module" src="thread.js"></script>
</body>
</html>
